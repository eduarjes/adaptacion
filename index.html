<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />	
		<title>Andújar</title>
		<link rel="shortcut icon" type="image/x-icon" href="images/ico.png" />
		<!-- Leaflet -->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" 
			integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin=""/>		
		<!-- Plugin Leyenda -->
		<link rel="stylesheet" href="plugins/L.Control.HtmlLegend.css" />
		<!-- Plugin pantalla completa -->		
		<link rel="stylesheet" href="plugins/Control.FullScreen.css">
		<!-- Plugin Minmapa -->
		<link rel="stylesheet" href="plugins/Control.MiniMap.css" />
		<!-- Capas de Google -->		
		<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCaSBSTv2RhP_DRnZKYgzyy03KdlROXHa8" async defer></script>
		<!-- Plugin Geocoding -->		
		<link rel="stylesheet" href="plugins/Control.Geocoder.css" />
		<!-- Plugin Sidebar -->		
		<link rel="stylesheet" href="plugins/L.Control.Sidebar.css">
		<!-- Plugin home -->		
		<link rel="stylesheet" href="plugins/font-awesome.min.css"/>
		<link rel="stylesheet" href="plugins/leaflet.zoomhome.css"/>		
		<style>
			body {
				padding: 0;
				margin: 0;
				}
				html, body, #map {
				height: 100%;
				}
			.info1 {
				padding: 1px 1px;
				font: 10px/16px Arial, Helvetica, sans-serif;
				background: white;
				text-align: center;
				line-height: 20px;
				background: rgba(255,255,255,0.8);
				box-shadow: 0 0 15px rgba(0,0,0,0.2);
				border-radius: 5px;
				}
			.info2 {
				padding: 6px 8px;
				font: 14px/16px Arial, Helvetica, sans-serif;
				background: white;
				text-align: center;
				line-height: 25px;
				background: rgba(255,255,255,0.8);
				box-shadow: 0 0 15px rgba(0,0,0,0.2);
				border-radius: 5px;
			}
			.info3 {
				position:absolute;
				right:165px;
				bottom:17px;
				overflow: hidden;
				border: none;
				background: white;
				opacity: 1;
				border-radius: 5px;
				z-index:2000;
			}
			.info h2 {
				margin: 0 0 5px;
				color: #777;
			}
			h3 { 
			    width: 270px;
				display: block;
				font-size: 1.4em;
				margin-top: 0.0em;
				margin-bottom: 0.0em;
				margin-left: 0;
				margin-right: 0;
				font-weight: bold;
			}
			h5 { 
				display: block;
				margin-top: 0.0em;
				margin-bottom: 0.0em;
				margin-left: 0;
				margin-right: 0;
				font-weight: bold;
			}
			#norte {
				position:absolute;
				left:50px;
				top:20px;
				overflow: hidden;
				border: none;
				background-color: rgb(0,0,255);
				opacity: 0.7;
				border-radius: 800px;
				z-index:2000;
			}
			.legend {
				 line-height: 18px;
				 text-align: center;
				 color: #555;
			}
			.legend i {
				 width: 18px;
				 height: 18px;
				 float: left;
				 margin-right: 8px;
				 opacity: 0.7;
			}
			.label {
				padding: 50px 50px;
				font: 14px/16px Arial, Helvetica, sans-serif;
				background: white;
				background: rgba(255,255,255,0.8);
				box-shadow: 0 0 15px rgba(0,0,0,0.2);
				border-radius: 7px;
			}
			.botoninfo	{
				padding: 0px 0px;
				width: 34px;
				height: 34px;
				box-shadow: 0 0 15px rgba(0,0,0,0.2);
				background: "white";
				border-radius: 5px
				z-index:2001;
			}
			.leaflet-control.leaflet-bar.leaflet-html-legend	{
				width: 290px;
				line-height: 20px;
			}
			.leaflet-control-layers.leaflet-control-layers-expanded.leaflets-control	{
				width: 180px;
				padding: 20px 8px;
				line-height: 25px;
			}
			.h4.closed	{
				line-height: 1px;
				display: block;
				font-size: 1.4em;
				margin-top: 0.0em;
				margin-bottom: 0.0em;
				margin-left: 0;
				margin-right: 0;
				font-weight: bold;
			}
			.legend-row {
				line-height: 15px;
				display: block;
				font-size: 1.4em;
				margin-top: 0.0em;
				margin-bottom: 0.0em;
				margin-left: 0;
				margin-right: 0;
				font-weight: bold;
			}
			.leaflet-control-minimap leaflet-container leaflet-touch leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom leaflet-control{
				padding: 0px 0px;
				width: 34px;
				height: 34px;
			}			
		</style>
	</head>
	
	<body>
		<!-- Leaflet -->					
		<script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
			integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin=""></script>
		<!-- Plugin Leyenda -->
		<script src="plugins/L.Control.HtmlLegend.min.js"></script>
		<!-- Plugin FullScreen -->		
		<script src="plugins/Control.FullScreen.js"></script>
		<!-- Plugin minimapa -->			
		<script src="plugins/Control.MiniMap.js" type="text/javascript"></script> 
		<!-- Plugin zoomhome -->			
		<script src="plugins/leaflet.zoomhome.min.js"></script>
		<!-- Plugin localizador -->	
		<script src="plugins/Control.Geocoder.js"></script>
		<!-- Plugin capas de Google -->
		<script src='https://unpkg.com/leaflet.gridlayer.googlemutant@latest/Leaflet.GoogleMutant.js'></script>
		<!-- Plugin sidebar -->		
		<script src="plugins/L.Control.Sidebar.js"></script>
		<script src="plugins/L.Control.Button.js"></script>
		<!-- Archivos GeoJson -->
		<script type="text/javascript" src="promujer_mayorsig.js"></script>
		<script type="text/javascript" src="comunidades_line_3.js"></script>
		<!-- botón ayuda -->
			<div id="sidebar"  style="width:290px; ">
				<h2>INSTRUCCIONES DE USO</h2>
				<p><b><img src="images/capas.png" width="16%" align="center"></img> Selecionar el mapa de la variable que desea visualizar  </b></p>
				<p><b><img src="images/dedo.png" width="12%" align="center"></img>  Deslizar sobre el mapa o pulsar para ver datos </b></p>
				<p><b><img src="images/mover.png" width="12%" align="center"></img>  Pulsar y mantener para desplazar el mapa  </b></p>				
				<p><b><img src="images/mas.png" width="16%" align="center"></img> Pulsar para acercar el mapa </b></p>	
				<p><b><img src="images/home.png" width="16%" align="center"></img> Pulsar para volver a la posición inicial </b></p>				
				<p><b><img src="images/menos.png" width="16%" align="center"></img> Pulsar para alejar el mapa </b></p>
				<p><b><img src="images/full.png" width="16%" align="center"></img> Pulsar para ver en pantalla completa </b></p>
				<p><b><img src="images/search.png" width="16%" align="center"></img> Introducir el município (localidad) que desea buscar </b></p>
				<p><b><img src="images/info.png" width="16%" align="center"></img> Pulsar para ver las Administraciones que apoyan/cofinancian el presente visor cartográfico </b></p>
				<p><b><img src="images/minimapa.png" width="16%" align="center"></img> Pulsar para minimizar el mapa de situación </b></p>
				<p><b><img src="images/leyenda.png" width="16%" align="center"></img> Pulsar para minimizar la leyenda </b></p> <br>	
				<a href="https://www.fundacionmatrix.es"><img src="images/matrix3.png" width="100%" align="center" ></img></a>
			</div>
		<!-- botón información -->			
			<div id="sidebar2"  style="width:410px; ">
				<a href="https://www.fundacionmatrix.es"><img src="images/matrix2.png" width="100%" align="center" ></img></a>
				<h2>CON EL APOYO DE:</h2>
				<a><img src="images/MSSSIyMAPAMA.png" width="100%" align="center" ></img></a>
			</div>
		<!-- Brújula -->	
			<div id="map">		
					<div id="norteImagen">
					<img id="norte" src="images/norte2.png" width="60px" height="60px"  alt="0" title="Norte" />
			</div>
		<!-- Botones -->			
			<div id="botonera"></div>
				<button id="helpbutton" role="button" class="botoninfo"><img src="images/ayuda.png" width="28" height="28" align="left"></button>
		<!-- Botón Sidebar2  -->
			<div id="botonera2"></div>
			<button id="helpbutton2" role="button2" class="botoninfo2"><img src="images/info.png" width="32" height="35"></button>
		<!-- Mapa -->			
			<script>
			var map = L.map('map', {
					zoomControl: false,
					center: [38, -4],
					zoom: 11,
					minZoom: 3,
					maxZoom: 20,
					maxBounds: [
						[20, -50],
						[50, 50]
						],
					});
					map.createPane('límites');
					map.getPane('límites').style.zIndex = 650;
					map.getPane('límites').style.pointerEvents = 'none';
					map.createPane('popups');
					map.getPane('popups').style.zIndex = 1000;
					map.getPane('popups').style.pointerEvents = 'none';
					map.createPane('popups1');
					map.getPane('popups1').style.zIndex = 1500;
					map.getPane('popups1').style.pointerEvents = 'none';
			// Cartografía
			var Mapa_fondo = L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/ {z}/{x}/{y}.png', { maxZoom: 18, opacity: 0.4, 
			attribution: '<a href="http://www.openstreetmap.org/copyright">OpenStreetMap </a>| Map data © 2017 <a href="https://www.fundacionmatrix.es"><strong>Fundación Matrix</strong></a>',
			}).addTo(map);					
			var osm = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
			attribution: 'Map data &copy'
			});
			var osm1 = L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
			maxZoom: 18,
			opacity: 0,
			attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
			})
			var osm2 = new L.TileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
			minZoom: 0, 
			maxZoom: 13,
			});
			var osm3 = L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/ {z}/{x}/{y}.png', { maxZoom: 18, opacity: 0.4, 
			attribution: '<a href="http://www.openstreetmap.org/copyright">OpenStreetMap </a>| Map data © 2017 <a href="https://www.fundacionmatrix.es"><strong>Fundación Matrix</strong></a>',
			});
			//Título
			var title2 = L.control({position: 'topright'});
				title2.onAdd = function (map) {
			var div = L.DomUtil.create('div', 'info2');
				 div.innerHTML +=
				 'VISOR CARTOGRÁFICO<h3>Indicadores demográficos de población mayor de España (provincias)</h3>';
				 return div;
				};
				title2.addTo(map);
			//Logo Matrix	
			var title1 = L.control({position: 'bottomright'});
				title1.onAdd = function (map) {
			var div = L.DomUtil.create('div', 'info1');
				 div.innerHTML +=
				 '<a href="https://www.fundacionmatrix.es"><img src="images/matrix.png" width="75%" ></img></a>';
				 return div;
				};
				title1.addTo(map);
			//Logo MAYORSIG	
			var title3 = L.control({position: 'bottomright'});
				title3.onAdd = function (map) {
			var div = L.DomUtil.create('div','info3');
				 div.innerHTML +=
				 '<a><img src="images/MAYORSIG.png" width="100px" height="63px" ></img></a>';
				 return div;
				};
				title3.addTo(map);
			//minimapa	
			var miniMap = new L.Control.MiniMap(osm2, { toggleDisplay: true, position:"bottomright", width:100,height:100,}).addTo(map); 					
			//zoomHome
			var zoomHome = L.Control.zoomHome({ position: 'topleft', homeCoordinates:[40, -5], zoomHomeTitle:'Posición inicial'}).addTo(map);	
			//Edad media
			function getColor1(a) {
			return a > 46 ? '#67000d' :
			a > 42 ? '#ef3b2c' :
			a > 38 ? '#fc9272' :					 
			a > 0 ? '#fff5f0' :
			'#fff5f0';
			}
			function style1(feature) {
			return {
			fillColor: getColor1(feature.properties.EM),
			weight: 1.5,
			opacity: 0.7,
			color: '#7B7D7D',
			dashArray: '1',
			fillOpacity: 0.5
			};
			}
			function popup1(feature, layer) {
			if (feature.properties && feature.properties.PROVINCIA) {
			layer.bindPopup("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Edad media: "+feature.properties.EM1+" años",{pane: 'popups1'});
			layer.bindTooltip("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Edad media: "+feature.properties.EM1+" años",{direction:"top",sticky:true, permanente:true,offset:[0,-5], pane: 'popups'} );
			}
			}
			var geojson1 = L.geoJson(tabla, {
			style: style1,
			onEachFeature: popup1
			})			
			//Porcentaje de personas mayores 65
			function getColor2(a) {
			return a > 27.50 ? '#330007' :
			a > 25 ? '#67000d' :
			a > 22.5 ? '#a50f15' :
			a > 20 ? '#ef3b2c' :
			a > 17.5 ? '#fb6a4a' :
			a > 15 ? '#fc9272' :
			a > 12.5 ? '#fcbba1' :
			a > 0 ? '#fff5f0' :
			'#fff5f0';
			}	
			function style2(feature) {
			return {
			fillColor: getColor2(feature.properties.P_65),
			weight: 1.5,
			opacity: 0.7,
			color: '#7B7D7D',
			dashArray: '1',
			fillOpacity: 0.5
			};
			}
			function popup2(feature, layer) {
			if (feature.properties && feature.properties.PROVINCIA) {
			layer.bindPopup("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Proporción de población: "+feature.properties.p_65_1+" %",{pane: 'popups1'});
			layer.bindTooltip("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Proporción de población: "+feature.properties.p_65_1+" %",{direction:"top",sticky:true, permanente:true,offset:[0,-5], pane: 'popups'});			
			}
			}  
			var geojson2 = L.geoJson(tabla, {
			style: style2,
			onEachFeature: popup2
			})
			//Indice de envejecimiento poblacional
			function getColor3(a) {
		    return a > 250 ? '#330007' :
			a > 200 ? '#a50f15' :
	        a > 150 ? '#ef3b2c' :					 
		    a > 100 ? '#fb6a4a' :
		    a > 50 ? '#fc9272' :
			a > 0 ? '#fff5f0' :
		    '#fff5f0';
			}
			function style3(feature) {
			return {
			fillColor: getColor3(feature.properties.IE),
			weight: 1.5,
			opacity: 0.7,
			color: '#7B7D7D',
			dashArray: '1',
			fillOpacity: 0.5
			};
			}
			function popup3(feature, layer) {
			if (feature.properties && feature.properties.PROVINCIA) {
			layer.bindPopup("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Índice de envejecimiento: "+feature.properties.IE_1+" %",{pane: 'popups1'});
			layer.bindTooltip("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Índice de envejecimiento: "+feature.properties.IE_1+" %",{direction:"top",sticky:true, permanente:true,offset:[0,-5], pane: 'popups'} );
			}
			}  
			var geojson3 = L.geoJson(tabla, {
			style: style3,
			onEachFeature: popup3
			})												
			//Indice de sobre-envejecimiento
			function getColor4(a) {
			return a > 40 ? '#330007' :
			a > 35 ? '#a50f15' :
			a > 30 ? '#fb6a4a' :					 
			a > 0 ? '#fcbba1' :
			'#fff5f0';
			}
			function style4(feature) {
			return {
			fillColor: getColor4(feature.properties.ISE),
			weight: 1.5,
			opacity: 0.7,
			color: '#7B7D7D',
			dashArray: '1',
			fillOpacity: 0.5
			};
			}
			function popup4(feature, layer) {
			if (feature.properties && feature.properties.PROVINCIA) {
			layer.bindPopup("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Índice de sobre-envejecimiento: "+feature.properties.ISE_1+" %",{pane: 'popups1'});
			layer.bindTooltip("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Índice de sobre-envejecimiento: "+feature.properties.ISE_1+" %",{direction:"top",sticky:true, permanente:true,offset:[0,-5], pane: 'popups'} );
			}
			}   
			var geojson4 = L.geoJson(tabla, {
			style: style4,
			onEachFeature: popup4
			})
			//Tasa de dependencia de mayores (2016)
			function getColor5(a) {
		    return a > 50 ? '#330007' :
			a > 40 ? '#a50f15' :					 
			a > 30 ? '#fb6a4a' :
		    a > 20 ? '#fcbba1' :
			a > 0 ? '#fff5f0' :
		    '#fff5f0';
			}
			function style5(feature) {
			return {
			fillColor: getColor5(feature.properties.TDM),
			weight: 1.5,
			opacity: 0.7,
			color: '#7B7D7D',
			dashArray: '1',
			fillOpacity: 0.5
			};
			}
			function popup5(feature, layer) {
			if (feature.properties && feature.properties.PROVINCIA) {
			layer.bindPopup("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Tasa de dependencia: "+feature.properties.TDM_1+" %",{pane: 'popups1'});
			layer.bindTooltip("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Tasa de dependencia: "+feature.properties.TDM_1+" %",{direction:"top",sticky:true, permanente:true,offset:[0,-5], pane: 'popups'} );
			}
			}   
			var geojson5 = L.geoJson(tabla, {
			style: style5,
			onEachFeature: popup5
			})												
			//Mortalidad de personas mayores (≥65 años) - 2016
			function getColor6(a) {
			return a > 49 ? '#330007' :
			a > 46 ? '#a50f15' :
			a > 43 ? '#fb6a4a' :					 
			a > 40 ? '#ffac8b' :
			a > 0 ?  '#ffceba':
			'#fff5f0';
			}
			function style6(feature) {
			return {
			fillColor: getColor6(feature.properties.TBM65),
			weight: 1.5,
			opacity: 0.7,
			color: '#7B7D7D',
			dashArray: '1',
			fillOpacity: 0.5
			};
			}
			function popup6(feature, layer) {
			if (feature.properties && feature.properties.PROVINCIA) {
			layer.bindPopup("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Tasa bruta de mortalidad: "+feature.properties.TBM65_1+" ‰",{pane: 'popups1'});
			layer.bindTooltip("<h2>"+feature.properties.PROVINCIA+" "+"</h2>"+"Tasa bruta de mortalidad: "+feature.properties.TBM65_1+" ‰",{direction:"top",sticky:true, permanente:true,offset:[0,-5], pane: 'popups'} );
			}
			}     
			var geojson6 = L.geoJson(tabla, {
			style: style6,
			onEachFeature: popup6
			})
			//fullscreen						
			var fsControl = new L.Control.FullScreen();
				map.addControl(fsControl);
				map.on('enterFullscreen', function(){
				if(window.console) window.console.log('enterFullscreen');
				});
				map.on('exitFullscreen', function(){
				if(window.console) window.console.log('exitFullscreen');
				});
			L.control.scale().addTo(map);
			//Buscador
			var geocoder = L.Control.geocoder({ position: 'topleft',
				}).addTo (map);
			//Límites
			var comunidades = L.geoJson(comunidades, {
				color: "#17202A", 
				weight: 2,
				opacity: 1,
				fillOpacity: 0,
				pane: 'límites',
				attribution: '| © <a href="http://www.ign.es">Instituto Geográfico Nacional |'				
				}).addTo(map);
			var provincias = L.geoJson(tabla, {
				color: "#424242", 
				weight: 1,
				opacity: 1,
				fillOpacity: 0,
				attribution: '| © <a href="http://www.ign.es">Instituto Geográfico Nacional |'
				});	
			//Capas Google
			var roadMutant = L.gridLayer.googleMutant({
				maxZoom: 24,
				type:'roadmap'
				});
			var satMutant = L.gridLayer.googleMutant({
				maxZoom: 24,
				type:'satellite'
				});
			var terrainMutant = L.gridLayer.googleMutant({
				maxZoom: 24,
				type:'terrain'
				});
			//Capas	
			var mapa1 = L.layerGroup([geojson1,]).addTo(map);
			var mapa2 = L.layerGroup([geojson2]);
			var mapa3 = L.layerGroup([geojson3]);
			var mapa4 = L.layerGroup([geojson4]);
			var mapa5 = L.layerGroup([geojson5]);
			var mapa6 = L.layerGroup([geojson6]);
			var baseLayers = {
					"Edad media poblacional (2016)":mapa1,
					"Porcentaje de personas mayores (2016)": mapa2,
					"Índice de envejecimiento poblacional (2016)":mapa3,
					"Índice de sobre-envejecimiento poblacional (2016)":mapa4,
					"Tasa de dependencia de mayores (2016)":mapa5,
					"Mortalidad de personas mayores (2015)":mapa6,
					"Sin variables": osm3,
					};
			var overlays = {
					"<b>Límites de Comunidades Autónomas<b>": comunidades,
					"OpenStreetMap": osm,
					"Base física (Google Terrain)": terrainMutant,	
					"Satélite (Google Satellite)": satMutant,						
					};
				// leyenda mapa6		
				var htmlLegend6 = L.control.htmllegend({
						position: 'bottomleft',
						legends: [{
							name: "<h3>"+'Mortalidad de personas mayores (2015)'+"<\h3>"+"<h4>"+  'Tasa de mortalidad de personas ≥65 años (‰)'+"<\h4>",
							style: style6,
							layer: mapa6,
							elements: [{
								label:"<h3>"+  '37,1 - 40'+"<\h3>",html: '',style: {'background-color': '#ffceba','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '40,1 - 43'+"<\h3>",html: '',style: {'background-color': '#ffac8b','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '43,1 - 46'+"<\h3>",html: '',style: {'background-color': '#fb6a4a','width': '14px','height': '14px'}}, {		
								label:"<h3>"+  '46,1 - 49'+"<\h3>",html: '',style: {'background-color': '#a50f15','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '49,1 - 50,3'+"<\h3>",html: '',style: {'background-color': '#330007','width': '14px','height': '14px'}}, {
								label:"<h5>"+  ''+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}}, {			
								label:"<h5>"+  'Número total de defunciones: 361.938'+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}}, {
								label:"<h5>"+  ''+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}}, {
								label:"<h5>"+  'Fuente: elaboración propia desde datos del Instituto Nacional de Estadística (INE) (Programa MAYORSIG y Proyecto IMPACTSIG)'+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}, 																
								}]}],
							collapseSimple: true,
							detectStretched: true,  
							collapsedOnInit: false,  
							defaultOpacity: 0.5, 
							visibleIcon: '',
							hiddenIcon: '',
							toggleIcon:'',
							});
						map.addControl(htmlLegend6);
				// leyenda mapa5
				var htmlLegend5 = L.control.htmllegend({
						position: 'bottomleft',
						legends: [{
							name: "<h3>"+ 'Tasa de dependencia de mayores (2016)'+"<\h3>"+"<h4>"+  'TDM= ≥65 años *100 / Población 16-64 años (%)'+"<\h4>",
							style: style5,
							layer: mapa5,
							elements: [{
								label:"<h3>"+  '14,7 - 20'+"<\h3>",html: '',style: {'background-color': '#fff5f0','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '20,1 - 30'+"<\h3>",html: '',style: {'background-color': '#fcbba1','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '30,1 - 40'+"<\h3>",html: '',style: {'background-color': '#fb6a4a','width': '14px','height': '14px'}}, {		
								label:"<h3>"+  '40,1 - 50'+"<\h3>",html: '',style: {'background-color': '#a50f15','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '50,1 - 52,1'+"<\h3>",html: '',style: {'background-color': '#330007','width': '14px','height': '14px'}}, {	
								label:"<h5>"+  ''+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}}, {
								label:"<h5>"+  'Fuente: elaboración propia desde datos del Instituto Nacional de Estadística (INE) (Programa MAYORSIG y Proyecto IMPACTSIG)'+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'},																
							}]}],
							collapseSimple: true,
							detectStretched: true,  
							collapsedOnInit: false,  
							defaultOpacity: 0.5, 
							visibleIcon: '',
							hiddenIcon: '',
							toggleIcon:'',
							}).addTo(map);
						map.addControl(htmlLegend5);	
				// leyenda mapa4		
				var htmlLegend4 = L.control.htmllegend({
						position: 'bottomleft',
						legends: [{
							name: "<h3>"+'Índice de sobre-envejecimiento poblacional (2016)'+"<\h3>"+"<h4>"+  'IS= Población ≥80 años *100 / Población ≥65 años (%)'+"<\h4>",
							style: style4,
							layer: mapa4,
							elements: [{
								label:"<h3>"+  '25,5 - 30'+"<\h3>",html: '',style: {'background-color': '#fcbba1','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '30,1 - 35'+"<\h3>",html: '',style: {'background-color': '#fb6a4a','width': '14px','height': '14px'}}, {		
								label:"<h3>"+  '35,1 - 40'+"<\h3>",html: '',style: {'background-color': '#a50f15','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '40,1 - 43'+"<\h3>",html: '',style: {'background-color': '#330007','width': '14px','height': '14px'}}, {
								label:"<h5>"+  ''+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}}, {
								label:"<h5>"+  'Fuente: elaboración propia desde datos del Instituto Nacional de Estadística (INE) (Programa MAYORSIG y Proyecto IMPACTSIG)'+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}, 																
								}]}],
							collapseSimple: true,
							detectStretched: true,  
							collapsedOnInit: false,  
							defaultOpacity: 0.5, 
							visibleIcon: '',
							hiddenIcon: '',
							toggleIcon:'',
							});
						map.addControl(htmlLegend4);
				// leyenda mapa3
				var htmlLegend3 = L.control.htmllegend({
						position: 'bottomleft',
						legends: [{
							name: "<h3>"+ 'Índice de envejecimiento poblacional (2016)'+"<\h3>"+"<h4>"+  'IE= Población ≥65 años *100 / Población ≤15 años (%)'+"<\h4>",
							style: style3,
							layer: mapa3,
							elements: [{
								label:"<h3>"+  '39,4 - 50'+"<\h3>",html: '',style: {'background-color': '#fff5f0','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '50,1 - 100'+"<\h3>",html: '',style: {'background-color': '#fc9272','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '100,1 - 150'+"<\h3>",html: '',style: {'background-color': '#fb6a4a','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '150,1 - 200'+"<\h3>",html: '',style: {'background-color': '#ef3b2c','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '200,1 - 250'+"<\h3>",html: '',style: {'background-color': '#a50f15','width': '14px','height': '14px'}}, {		
								label:"<h3>"+  '250,1 - 292,5'+"<\h3>",html: '',style: {'background-color': '#330007','width': '14px','height': '14px'}}, { 	
								label:"<h5>"+  ''+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}}, {	
								label:"<h5>"+  'Fuente: elaboración propia desde datos del Instituto Nacional de Estadística (INE) (Programa MAYORSIG y Proyecto IMPACTSIG)'+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'},																
							}]}],
							collapseSimple: true,
							detectStretched: true,  
							collapsedOnInit: false,  
							defaultOpacity: 0.5, 
							visibleIcon: '',
							hiddenIcon: '',
							toggleIcon:'',
							}).addTo(map);
						map.addControl(htmlLegend3);					
				// leyenda mapa2		
				var htmlLegend2 = L.control.htmllegend({
						position: 'bottomleft',
						legends: [{
							name: "<h3>"+'Porcentaje de personas mayores (2016)'+"<\h3>"+"<h4>"+  'Personas ≥ 65 años (%)'+"<\h4>",
							style: style2,
							layer: mapa2,
							elements: [{
								label:"<h3>"+  '≤ 12,5'+"<\h3>",html: '',style: {'background-color': '#fff5f0','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '12,51 - 15'+"<\h3>",html: '',style: {'background-color': '#fcbba1','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '15,1 - 17,5'+"<\h3>",html: '',style: {'background-color': '#fc9272','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '17,51 - 20'+"<\h3>",html: '',style: {'background-color': '#fb6a4a','width': '14px','height': '14px'}}, {		
								label:"<h3>"+  '20,1 - 22,5'+"<\h3>",html: '',style: {'background-color': '#ef3b2c','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '22,51 - 25'+"<\h3>",html: '',style: {'background-color': '#a50f15','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '25,1 - 27,5'+"<\h3>",html: '',style: {'background-color': '#67000d','width': '14px','height': '14px'}}, {							
								label:"<h3>"+  '≥ 27,51'+"<\h3>",html: '',style: {'background-color': '#330007','width': '14px','height': '14px'}}, {
								label:"<h5>"+  ''+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}}, {
								label:"<h5>"+  'Fuente: elaboración propia desde datos del Instituto Nacional de Estadística (INE) (Programa MAYORSIG y Proyecto IMPACTSIG)'+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}, 																
								}]}],
							collapseSimple: true,
							detectStretched: true,  
							collapsedOnInit: false,  
							defaultOpacity: 0.5, 
							visibleIcon: '',
							hiddenIcon: '',
							toggleIcon:'',
							});
						map.addControl(htmlLegend2);
				// leyenda mapa1		
				var htmlLegend1 = L.control.htmllegend({
						position: 'bottomleft',
						legends: [{
							name: "<h3>"+'Edad media poblacional (2016)'+"<\h3>"+"<h4>"+  'Edad media poblacional provincial (años)'+"<\h4>",
							style: style1,
							layer: mapa1,
							elements: [{
								label:"<h3>"+  '34 - 38'+"<\h3>",html: '',style: {'background-color': '#fff5f0','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '38,1 - 42'+"<\h3>",html: '',style: {'background-color': '#fc9272','width': '14px','height': '14px'}}, {		
								label:"<h3>"+  '42,1 - 46'+"<\h3>",html: '',style: {'background-color': '#ef3b2c','width': '14px','height': '14px'}}, {
								label:"<h3>"+  '46,1 - 50'+"<\h3>",html: '',style: {'background-color': '#67000d','width': '14px','height': '14px'}}, {
								label:"<h5>"+  ''+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}}, {
								label:"<h5>"+  'Fuente: elaboración propia desde datos del Instituto Nacional de Estadística (INE) (Programa MAYORSIG y Proyecto IMPACTSIG)'+"<\h5>",html: '',style: {'background-color': 'write','width': '0px','height': '0px'}, 																
								}]}],
							collapseSimple: true,
							detectStretched: true,  
							collapsedOnInit: false,  
							defaultOpacity: 0.5, 
							visibleIcon: '',
							hiddenIcon: '',
							toggleIcon:'',
							});
						map.addControl(htmlLegend1);  
				//Visualizar capas
				L.control.layers(baseLayers, overlays,{collapsed:true, position: 'topright',}).addTo(map);
			//Botones	
			var sidebar = L.control.sidebar('sidebar', { closeButton:true, position: 'left' });
			map.addControl(sidebar);
				sidebar.hide();			
				sidebar.show();
				sidebar.toggle();
			var visible = sidebar.isVisible();
			var button = new L.Control.Button(L.DomUtil.get('helpbutton'), { toggleButton: 'active', position: 'topleft'});
				button.addTo(map);
				button.on('click', function () {
				 if (button.isToggled()) {
						sidebar.hide();
					} else {
						sidebar.show();
					}
				});
			var sidebar2 = L.control.sidebar('sidebar2', { closeButton:true, position: 'right' });
			map.addControl(sidebar2);
				sidebar2.hide();			
				sidebar2.show();
				sidebar2.toggle();
			var visible2 = sidebar.isVisible();
			var button2 = new L.Control.Button(L.DomUtil.get('helpbutton2'), { toggleButton: 'active', position: 'topright'});
				button2.addTo(map);
				button2.on('click', function () {
				 if (button2.isToggled()) {
						sidebar2.hide();
					} else {
						sidebar2.show();
					}
				});
		</script>
	</body>
</html>
